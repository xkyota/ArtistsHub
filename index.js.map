{"version":3,"file":"index.js","sources":["../src/js/artists-section.js"],"sourcesContent":["export const artistIDs = [];\nlet currentPage = 1;\nconst LIMIT = 8;\n\nconst refs = {\n  cardsContainer: document.querySelector('.block-artist__list'),\n  loadMoreBtn: document.querySelector('.block-artist-wrapper__button'),\n};\n\nrefs.loadMoreBtn.classList.remove('hidden');\n\nasync function fetchArtists(page = 1, limit = LIMIT) {\n  const response = await fetch(`https://sound-wave.b.goit.study/api/artists?page=${page}&limit=${limit}`);\n  if (!response.ok) throw new Error('Error: ' + response.status);\n  return response.json();\n}\n\nfunction renderArtists(artists, container) {\n  artists.forEach(artist => {\n    artistIDs.push(artist._id);\n\n    const genresMarkup = artist.genres\n      .map(genre => `<span class=\"block-artist-list-item-wrapper-text__span\">${genre}</span>`)\n      .join('');\n\n    const bioShort = artist.strBiographyEN.length > 200\n      ? artist.strBiographyEN.slice(0, 200) + '...'\n      : artist.strBiographyEN;\n\n    container.insertAdjacentHTML(\n      'beforeend',\n      `\n      <li class=\"block-artist-list__item\">\n        <div class=\"block-artist-list-item__wrapper-icon\">\n          <img src=\"${artist.strArtistThumb}\" alt=\"${artist.strArtist}\" class=\"block-artist-list-wrapper__icon\" width=\"672\" height=\"432\">\n        </div>\n        <div class=\"block-artist-list-item__wrapper-text\">\n          ${genresMarkup}\n        </div>\n        <h2 class=\"block-artist-list-item__title\">${artist.strArtist}</h2>\n        <p class=\"block-artist-list-item__paragraph\">${bioShort}</p>\n        <button class=\"block-artist-list-item__button\" data-id=\"${artist._id}\">\n          Learn More <img src=\"/img/artist-section/arrow-right.svg\" alt=\"arrow-right\">\n        </button>\n      </li>\n      `\n    );\n  });\n}\n\nasync function onLoadMoreBtnClick(event) {\n  event.target.blur();\n  currentPage++;\n  \n  try {\n    const { artists, totalArtists } = await fetchArtists(currentPage, LIMIT);\n    renderArtists(artists, refs.cardsContainer);\n\n    const firstNewCard = refs.cardsContainer.lastElementChild;\n    await new Promise(resolve => setTimeout(resolve, 100));\n    const cardHeight = firstNewCard.getBoundingClientRect().height;\n    window.scrollBy({ top: cardHeight * 1, behavior: 'smooth' });\n\n    const totalPages = Math.ceil(totalArtists / LIMIT);\n    if (currentPage >= totalPages) {\n      iziToast.info({\n        title: '',\n        message: 'Ви, передивились всіх артистів.',\n        position: 'topRight',\n        timeout: 4000,\n        titleColor: '#fff',\n        backgroundColor: '#764191',\n        messageColor: '#fff',\n      });\n      refs.loadMoreBtn.classList.add('hidden');\n      refs.loadMoreBtn.removeEventListener('click', onLoadMoreBtnClick);\n    }\n  } catch (err) {\n    console.error(err);\n  }\n}\n\n(async () => {\n  try {\n    const { artists, totalArtists } = await fetchArtists(currentPage, LIMIT);\n    renderArtists(artists, refs.cardsContainer);\n\n    const totalPages = Math.ceil(totalArtists / LIMIT);\n    if (currentPage >= totalPages) {\n      refs.loadMoreBtn.classList.add('hidden');\n    } else {\n      refs.loadMoreBtn.addEventListener('click', onLoadMoreBtnClick);\n    }\n  } catch (err) {\n    console.error(err);\n  }\n})();\n"],"names":["artistIDs","currentPage","LIMIT","refs","fetchArtists","page","limit","response","renderArtists","artists","container","artist","genresMarkup","genre","bioShort","onLoadMoreBtnClick","event","totalArtists","firstNewCard","resolve","cardHeight","totalPages","err"],"mappings":"ssBAAO,MAAMA,EAAY,CAAA,EACzB,IAAIC,EAAc,EAClB,MAAMC,EAAQ,EAERC,EAAO,CACX,eAAgB,SAAS,cAAc,qBAAqB,EAC5D,YAAa,SAAS,cAAc,+BAA+B,CACrE,EAEAA,EAAK,YAAY,UAAU,OAAO,QAAQ,EAE1C,eAAeC,EAAaC,EAAO,EAAGC,EAAQJ,EAAO,CACnD,MAAMK,EAAW,MAAM,MAAM,oDAAoDF,CAAI,UAAUC,CAAK,EAAE,EACtG,GAAI,CAACC,EAAS,GAAI,MAAM,IAAI,MAAM,UAAYA,EAAS,MAAM,EAC7D,OAAOA,EAAS,KAAI,CACtB,CAEA,SAASC,EAAcC,EAASC,EAAW,CACzCD,EAAQ,QAAQE,GAAU,CACxBX,EAAU,KAAKW,EAAO,GAAG,EAEzB,MAAMC,EAAeD,EAAO,OACzB,IAAIE,GAAS,2DAA2DA,CAAK,SAAS,EACtF,KAAK,EAAE,EAEJC,EAAWH,EAAO,eAAe,OAAS,IAC5CA,EAAO,eAAe,MAAM,EAAG,GAAG,EAAI,MACtCA,EAAO,eAEXD,EAAU,mBACR,YACA;AAAA;AAAA;AAAA,sBAGgBC,EAAO,cAAc,UAAUA,EAAO,SAAS;AAAA;AAAA;AAAA,YAGzDC,CAAY;AAAA;AAAA,oDAE4BD,EAAO,SAAS;AAAA,uDACbG,CAAQ;AAAA,kEACGH,EAAO,GAAG;AAAA;AAAA;AAAA;AAAA,OAK5E,CACA,CAAG,CACH,CAEA,eAAeI,EAAmBC,EAAO,CACvCA,EAAM,OAAO,KAAI,EACjBf,IAEA,GAAI,CACF,KAAM,CAAE,QAAAQ,EAAS,aAAAQ,CAAY,EAAK,MAAMb,EAAaH,EAAaC,CAAK,EACvEM,EAAcC,EAASN,EAAK,cAAc,EAE1C,MAAMe,EAAef,EAAK,eAAe,iBACzC,MAAM,IAAI,QAAQgB,GAAW,WAAWA,EAAS,GAAG,CAAC,EACrD,MAAMC,EAAaF,EAAa,sBAAqB,EAAG,OACxD,OAAO,SAAS,CAAE,IAAKE,EAAa,EAAG,SAAU,SAAU,EAE3D,MAAMC,EAAa,KAAK,KAAKJ,EAAef,CAAK,EAC7CD,GAAeoB,IACjB,SAAS,KAAK,CACZ,MAAO,GACP,QAAS,kCACT,SAAU,WACV,QAAS,IACT,WAAY,OACZ,gBAAiB,UACjB,aAAc,MACtB,CAAO,EACDlB,EAAK,YAAY,UAAU,IAAI,QAAQ,EACvCA,EAAK,YAAY,oBAAoB,QAASY,CAAkB,EAEtE,OAAWO,EAAK,CACZ,QAAQ,MAAMA,CAAG,CACrB,CACA,EAEC,SAAY,CACX,GAAI,CACF,KAAM,CAAE,QAAAb,EAAS,aAAAQ,CAAY,EAAK,MAAMb,EAAaH,EAAaC,CAAK,EACvEM,EAAcC,EAASN,EAAK,cAAc,EAE1C,MAAMkB,EAAa,KAAK,KAAKJ,EAAef,CAAK,EAC7CD,GAAeoB,EACjBlB,EAAK,YAAY,UAAU,IAAI,QAAQ,EAEvCA,EAAK,YAAY,iBAAiB,QAASY,CAAkB,CAEnE,OAAWO,EAAK,CACZ,QAAQ,MAAMA,CAAG,CACrB,CACA,GAAC"}